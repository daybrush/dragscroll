{"version":3,"file":"dragscroll.cjs.js","sources":["../src/DragScroll.ts"],"sourcesContent":["import EventEmitter from \"@scena/event-emitter\";\nimport { isFunction, isString, now } from \"@daybrush/utils\";\nimport { CheckScrollOptions, DragScrollEvents, DragScrollOptions, Rect } from \"./types\";\n\nfunction getDefaultScrollPosition(e: { container: HTMLElement, direction: number[] }) {\n    let container = e.container;\n\n    if (container === document.body) {\n        return [\n            container.scrollLeft || document.documentElement.scrollLeft,\n            container.scrollTop || document.documentElement.scrollTop,\n        ];\n    }\n    return [\n        container.scrollLeft,\n        container.scrollTop,\n    ];\n}\n\nfunction checkDefaultScrollEvent(container: HTMLElement | Window, callback: () => void) {\n    container.addEventListener(\"scroll\", callback);\n\n    return () => {\n        container.removeEventListener(\"scroll\", callback);\n    }\n}\n\nfunction getContainerElement(container: DragScrollOptions[\"container\"]): HTMLElement {\n    if (!container) {\n        return null;\n    } else if (isString(container)) {\n        return document.querySelector<HTMLElement>(container);\n    } if (isFunction(container)) {\n        return container();\n    } else if (container instanceof Element) {\n        return container;\n    } else if (\"current\" in container) {\n        return container.current;\n    } else if (\"value\" in container) {\n        return container.value;\n    }\n}\n\n/**\n * @sort 1\n */\nclass DragScroll extends EventEmitter<DragScrollEvents> {\n    private _startRect: Rect | null = null;\n    private _startPos: number[] = [];\n    private _prevTime: number = 0;\n    private _timer: number = 0;\n    private _prevScrollPos: number[] = [0, 0];\n    private _isWait = false;\n    private _flag = false;\n    private _currentOptions: DragScrollOptions | null = null;\n    private _lock = false;\n    private _unregister: (() => void) | null = null;\n    /**\n     */\n    public dragStart(e: any, options: DragScrollOptions) {\n        const container = getContainerElement(options.container);\n\n        if (!container) {\n            this._flag = false;\n            return;\n        }\n        let top = 0;\n        let left = 0;\n        let width = 0;\n        let height = 0;\n\n        if (container === document.body) {\n            width = window.innerWidth;\n            height = window.innerHeight;\n        } else {\n            const rect = container.getBoundingClientRect();\n\n            top = rect.top;\n            left = rect.left;\n            width = rect.width;\n            height = rect.height;\n        }\n\n        this._flag = true;\n        this._startPos = [e.clientX, e.clientY];\n        this._startRect = { top, left, width, height };\n        this._prevScrollPos = this._getScrollPosition([0, 0], options);\n        this._currentOptions = options;\n        this._registerScrollEvent(options);\n    }\n    public drag(e: any, options: DragScrollOptions) {\n        clearTimeout(this._timer);\n        if (!this._flag) {\n            return;\n        }\n        const {\n            clientX,\n            clientY,\n        } = e;\n        const {\n            threshold = 0,\n        } = options;\n        const {\n            _startRect,\n            _startPos,\n        } = this;\n\n\n        this._currentOptions = options;\n        const direction = [0, 0];\n\n        if (_startRect.top > clientY - threshold) {\n            if (_startPos[1] > _startRect.top || clientY < _startPos[1]) {\n                direction[1] = -1;\n            }\n        } else if (_startRect.top + _startRect.height < clientY + threshold) {\n            if (_startPos[1] < _startRect.top + _startRect.height || clientY > _startPos[1]) {\n                direction[1] = 1;\n            }\n        }\n        if (_startRect.left > clientX - threshold) {\n            if (_startPos[0] > _startRect.left || clientX < _startPos[0]) {\n                direction[0] = -1;\n            }\n        } else if (_startRect.left + _startRect.width < clientX + threshold) {\n            if (_startPos[0] < _startRect.left + _startRect.width || clientX > _startPos[0]) {\n                direction[0] = 1;\n            }\n        }\n\n        if (!direction[0] && !direction[1]) {\n            return false;\n        }\n        return this._continueDrag({\n            ...options,\n            direction,\n            inputEvent: e,\n            isDrag: true,\n        });\n    }\n    /**\n     */\n    public checkScroll(options: CheckScrollOptions) {\n        if (this._isWait) {\n            return false;\n        }\n        const {\n            prevScrollPos = this._prevScrollPos,\n            direction,\n            throttleTime = 0,\n            inputEvent,\n            isDrag,\n        } = options;\n        const nextScrollPos = this._getScrollPosition(direction || [0, 0], options);\n        const offsetX = nextScrollPos[0] - prevScrollPos[0];\n        const offsetY = nextScrollPos[1] - prevScrollPos[1];\n\n        const nextDirection = direction || [\n            offsetX ? Math.abs(offsetX) / offsetX : 0,\n            offsetY ? Math.abs(offsetY) / offsetY : 0,\n        ];\n        this._prevScrollPos = nextScrollPos;\n        this._lock = false;\n\n        if (!offsetX && !offsetY) {\n            return false;\n        }\n        /**\n         * @event DragScroll#move\n         */\n        this.emit(\"move\", {\n            offsetX: nextDirection[0] ? offsetX : 0,\n            offsetY: nextDirection[1] ? offsetY : 0,\n            inputEvent,\n        });\n\n        if (throttleTime && isDrag) {\n            clearTimeout(this._timer);\n            this._timer = window.setTimeout(() => {\n                this._continueDrag(options);\n            }, throttleTime);\n        }\n        return true;\n    }\n    /**\n     *\n     */\n    public dragEnd() {\n        this._flag = false;\n        this._lock = false;\n        clearTimeout(this._timer);\n        this._unregisterScrollEvent();\n    }\n    private _getScrollPosition(direction: number[], options: DragScrollOptions) {\n        const {\n            container,\n            getScrollPosition = getDefaultScrollPosition,\n        } = options;\n        return getScrollPosition({ container: getContainerElement(container), direction });\n    }\n    private _continueDrag(options: CheckScrollOptions) {\n        const {\n            container,\n            direction,\n            throttleTime,\n            useScroll,\n            isDrag,\n            inputEvent,\n        } = options;\n\n        if (!this._flag || (isDrag && this._isWait)) {\n            return;\n        }\n        const nowTime = now();\n        const distTime = Math.max(throttleTime + this._prevTime - nowTime, 0);\n\n        if (distTime > 0) {\n            clearTimeout(this._timer);\n            this._timer = window.setTimeout(() => {\n                this._continueDrag(options);\n            }, distTime);\n\n            return false;\n        }\n        this._prevTime = nowTime;\n        const prevScrollPos = this._getScrollPosition(direction, options);\n\n        this._prevScrollPos = prevScrollPos;\n\n        if (isDrag) {\n            this._isWait = true;\n        }\n\n        // unregister native scroll event\n        if (!useScroll) {\n            this._lock = true;\n        }\n        const param = {\n            container: getContainerElement(container),\n            direction,\n            inputEvent,\n        };\n        options.requestScroll?.(param);\n        /**\n         * @event DragScroll#scroll\n         */\n        this.emit(\"scroll\", param);\n\n        this._isWait = false;\n        return useScroll || this.checkScroll({\n            ...options,\n            prevScrollPos,\n            direction,\n            inputEvent,\n        });\n    }\n\n    private _registerScrollEvent(options: DragScrollOptions) {\n        this._unregisterScrollEvent();\n        const checkScrollEvent = options.checkScrollEvent;\n\n        if (!checkScrollEvent) {\n            return;\n        }\n        const callback = checkScrollEvent === true ? checkDefaultScrollEvent : checkScrollEvent;\n        const container = getContainerElement(options.container);\n\n        if (checkScrollEvent === true && (container === document.body || container === document.documentElement)) {\n            this._unregister = checkDefaultScrollEvent(window, this._onScroll);\n        } else {\n            this._unregister = callback(container, this._onScroll);\n        }\n    }\n    private _unregisterScrollEvent() {\n        this._unregister?.();\n        this._unregister = null;\n    }\n\n    private _onScroll = () => {\n        const options = this._currentOptions;\n        if (this._lock || !options) {\n            return;\n        }\n\n        this.emit(\"scrollDrag\", {\n            next: (inputEvent: any) => {\n                this.checkScroll({\n                    container: options.container,\n                    inputEvent,\n                });\n            },\n        });\n    };\n}\n\nexport default DragScroll;\n"],"names":["getDefaultScrollPosition","e","container","document","body","scrollLeft","documentElement","scrollTop","checkDefaultScrollEvent","callback","addEventListener","removeEventListener","getContainerElement","isString","querySelector","isFunction","Element","current","value","__extends","_this","options","_currentOptions","_lock","emit","next","inputEvent","checkScroll","_flag","top","left","width","height","window","innerWidth","innerHeight","rect","getBoundingClientRect","_startPos","clientX","clientY","_startRect","_prevScrollPos","_getScrollPosition","_registerScrollEvent","clearTimeout","_timer","_a","threshold","_b","direction","_continueDrag","isDrag","_isWait","prevScrollPos","throttleTime","nextScrollPos","offsetX","offsetY","nextDirection","Math","abs","setTimeout","_unregisterScrollEvent","getScrollPosition","useScroll","nowTime","now","distTime","max","_prevTime","param","requestScroll","checkScrollEvent","_unregister","_onScroll","EventEmitter"],"mappings":"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"}