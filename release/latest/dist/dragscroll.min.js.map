{"version":3,"file":"dragscroll.min.js","sources":["../src/DragScroll.ts"],"sourcesContent":["import Component from \"@egjs/component\";\nimport { DragScrollOptions, Rect } from \"./types\";\n\nfunction getDefaultScrollPosition(e: { scrollContainer: HTMLElement, direction: number[] }) {\n    const scrollContainer = e.scrollContainer;\n\n    return [\n        scrollContainer.scrollLeft,\n        scrollContainer.scrollTop,\n    ];\n}\n\nexport default class DragScroll extends Component {\n    public options: DragScrollOptions;\n    private startRect: Rect | null = null;\n    private prevClientX = 0;\n    private prevClientY = 0;\n    private prevDirection: number[] | null = null;\n    private prevPos: number[] = [];\n    constructor(private container: HTMLElement, options: Partial<DragScrollOptions> = {}) {\n        super();\n        this.options = {\n            scrollThreshold: 0,\n            getScrollPosition: getDefaultScrollPosition,\n            ...options,\n        };\n    }\n    public dragStart() {\n        const {\n            top,\n            left,\n            width,\n            height,\n        } = this.container.getBoundingClientRect();\n\n        this.startRect = { top, left, width, height };\n    }\n    public drag(e: any) {\n        const {\n            clientX,\n            clientY,\n        } = e;\n        this.prevDirection = null;\n\n        const {\n            scrollThreshold = 0,\n            getScrollPosition = getDefaultScrollPosition,\n        } = this.options;\n        const {\n            container,\n            startRect,\n        } = this;\n\n        const direction = [0, 0];\n\n        if (startRect.top > clientY - scrollThreshold) {\n            direction[1] = -1;\n        } else if (startRect.top + startRect.height < clientY + scrollThreshold) {\n            direction[1] = 1;\n        }\n        if (startRect.left > clientX - scrollThreshold) {\n            direction[0] = -1;\n        } else if (startRect.left + startRect.width < clientX + scrollThreshold) {\n            direction[0] = 1;\n        }\n        if (!direction[0] && !direction[1]) {\n            return false;\n        }\n\n        this.prevDirection = direction;\n        this.prevPos = getScrollPosition({ scrollContainer: container, direction });\n\n        this.trigger(\"scroll\", {\n            scrollContainer: container,\n            direction,\n        });\n        return true;\n\n    }\n    public dragAfter() {\n        const {\n            prevPos,\n            prevDirection: direction,\n            container: scrollContainer,\n        } = this;\n\n        if (!this.prevDirection) {\n            return false;\n        }\n        const {\n            getScrollPosition,\n        } = this.options;\n        const nextPos = getScrollPosition({ scrollContainer, direction });\n        const offsetX = nextPos[0] - prevPos[0];\n        const offsetY = nextPos[1] - prevPos[1];\n\n        if (!offsetX && !offsetY) {\n            return false;\n        }\n        this.trigger(\"move\", {\n            offsetX: direction[0] ? offsetX : 0,\n            offsetY: direction[1] ? offsetY : 0,\n        });\n        return true;\n    }\n}\n"],"names":["getDefaultScrollPosition","e","scrollContainer","scrollLeft","scrollTop","container","options","_super","_this","scrollThreshold","getScrollPosition","_a","top","left","width","height","startRect","clientX","clientY","prevDirection","_b","_c","direction","prevPos","trigger","this","nextPos","offsetX","offsetY","Component"],"mappings":";;;;;;;;qoBAGA,SAASA,EAAyBC,OACxBC,EAAkBD,EAAEC,sBAEnB,CACHA,EAAgBC,WAChBD,EAAgBE,iFAWAC,EAAwBC,gBAAAA,YACxCC,0BADgBC,YAAAH,EALZG,YAAyB,KACzBA,cAAc,EACdA,cAAc,EACdA,gBAAiC,KACjCA,UAAoB,GAGxBA,EAAKF,WACDG,gBAAiB,EACjBC,kBAAmBV,GAChBM,2HAGX,eACUK,yCACFC,QACAC,SACAC,UACAC,gBAGCC,UAAY,CAAEJ,MAAKC,OAAMC,QAAOC,kBAEzC,SAAYd,OAEJgB,YACAC,iBAECC,cAAgB,SAEfR,eACFS,oBAAAX,iBACAY,sBAAAX,iBAGAL,iBACAW,iBAGEM,EAAY,CAAC,EAAG,UAElBN,EAAUJ,IAAMM,EAAUT,EAC1Ba,EAAU,IAAM,EACTN,EAAUJ,IAAMI,EAAUD,OAASG,EAAUT,IACpDa,EAAU,GAAK,GAEfN,EAAUH,KAAOI,EAAUR,EAC3Ba,EAAU,IAAM,EACTN,EAAUH,KAAOG,EAAUF,MAAQG,EAAUR,IACpDa,EAAU,GAAK,MAEdA,EAAU,KAAOA,EAAU,WAI3BH,cAAgBG,OAChBC,QAAUb,EAAkB,CAAER,gBAAiBG,EAAWiB,mBAE1DE,QAAQ,SAAU,CACnBtB,gBAAiBG,EACjBiB,eAEG,gBAGX,eACUX,OACFY,YACAD,kBACApB,kBAGCuB,KAAKN,qBACC,MAKLO,GAAUhB,kCAAkB,CAAER,kBAAiBoB,cAC/CK,EAAUD,EAAQ,GAAKH,EAAQ,GAC/BK,EAAUF,EAAQ,GAAKH,EAAQ,YAEhCI,IAAYC,UAGZJ,QAAQ,OAAQ,CACjBG,QAASL,EAAU,GAAKK,EAAU,EAClCC,QAASN,EAAU,GAAKM,EAAU,KAE/B,OA3FyBC"}