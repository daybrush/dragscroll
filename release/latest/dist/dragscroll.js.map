{"version":3,"file":"dragscroll.js","sources":["../src/DragScroll.ts"],"sourcesContent":["import Component from \"@egjs/component\";\nimport { DragScrollOptions, Rect } from \"./types\";\n\nfunction getDefaultScrollPosition(e: { scrollContainer: HTMLElement, direction: number[] }) {\n    const scrollContainer = e.scrollContainer;\n\n    return [\n        scrollContainer.scrollLeft,\n        scrollContainer.scrollTop,\n    ];\n}\n\nexport default class DragScroll extends Component {\n    public options: DragScrollOptions;\n    private startRect: Rect | null = null;\n    private prevClientX = 0;\n    private prevClientY = 0;\n    private prevDirection: number[] | null = null;\n    private prevPos: number[] = [];\n    constructor(private container: HTMLElement, options: Partial<DragScrollOptions> = {}) {\n        super();\n        this.options = {\n            scrollThreshold: 0,\n            getScrollPosition: getDefaultScrollPosition,\n            ...options,\n        };\n    }\n    public dragStart() {\n        const {\n            top,\n            left,\n            width,\n            height,\n        } = this.container.getBoundingClientRect();\n\n        this.startRect = { top, left, width, height };\n    }\n    public drag(e: any) {\n        const {\n            clientX,\n            clientY,\n        } = e;\n        this.prevDirection = null;\n\n        const {\n            scrollThreshold = 0,\n            getScrollPosition = getDefaultScrollPosition,\n        } = this.options;\n        const {\n            container,\n            startRect,\n        } = this;\n\n        const direction = [0, 0];\n\n        if (startRect.top > clientY - scrollThreshold) {\n            direction[1] = -1;\n        } else if (startRect.top + startRect.height < clientY + scrollThreshold) {\n            direction[1] = 1;\n        }\n        if (startRect.left > clientX - scrollThreshold) {\n            direction[0] = -1;\n        } else if (startRect.left + startRect.width < clientX + scrollThreshold) {\n            direction[0] = 1;\n        }\n        if (!direction[0] && !direction[1]) {\n            return false;\n        }\n\n        this.prevDirection = direction;\n        this.prevPos = getScrollPosition({ scrollContainer: container, direction });\n\n        this.trigger(\"scroll\", {\n            scrollContainer: container,\n            direction,\n        });\n        return true;\n\n    }\n    public dragAfter() {\n        const {\n            prevPos,\n            prevDirection: direction,\n            container: scrollContainer,\n        } = this;\n\n        if (!this.prevDirection) {\n            return false;\n        }\n        const {\n            getScrollPosition,\n        } = this.options;\n        const nextPos = getScrollPosition({ scrollContainer, direction });\n        const offsetX = nextPos[0] - prevPos[0];\n        const offsetY = nextPos[1] - prevPos[1];\n\n        if (!offsetX && !offsetY) {\n            return false;\n        }\n        this.trigger(\"move\", {\n            offsetX: direction[0] ? offsetX : 0,\n            offsetY: direction[1] ? offsetY : 0,\n        });\n        return true;\n    }\n}\n"],"names":["getDefaultScrollPosition","e","scrollContainer","scrollLeft","scrollTop","__extends","container","options","_super","_this","scrollThreshold","getScrollPosition","_a","top","left","width","height","startRect","clientX","clientY","prevDirection","_b","_c","_d","direction","prevPos","trigger","nextPos","offsetX","offsetY","Component"],"mappings":"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"}