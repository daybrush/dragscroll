{"version":3,"file":"dragscroll.esm.js","sources":["../src/DragScroll.ts"],"sourcesContent":["import Component from \"@egjs/component\";\nimport { DragScrollOptions, Rect } from \"./types\";\n\nfunction getDefaultScrollPosition(e: { scrollContainer: HTMLElement, direction: number[] }) {\n    const scrollContainer = e.scrollContainer;\n\n    return [\n        scrollContainer.scrollLeft,\n        scrollContainer.scrollTop,\n    ];\n}\n\nexport default class DragScroll extends Component {\n    public options: DragScrollOptions;\n    private startRect: Rect | null = null;\n    private prevClientX = 0;\n    private prevClientY = 0;\n    private prevDirection: number[] | null = null;\n    private prevPos: number[] = [];\n    constructor(private container: HTMLElement, options: Partial<DragScrollOptions> = {}) {\n        super();\n        this.options = {\n            scrollThreshold: 0,\n            getScrollPosition: getDefaultScrollPosition,\n            ...options,\n        };\n    }\n    public dragStart() {\n        const {\n            top,\n            left,\n            width,\n            height,\n        } = this.container.getBoundingClientRect();\n\n        this.startRect = { top, left, width, height };\n    }\n    public drag(e: any) {\n        const {\n            clientX,\n            clientY,\n        } = e;\n        this.prevDirection = null;\n\n        const {\n            scrollThreshold = 0,\n            getScrollPosition = getDefaultScrollPosition,\n        } = this.options;\n        const {\n            container,\n            startRect,\n        } = this;\n\n        const direction = [0, 0];\n\n        if (startRect.top > clientY - scrollThreshold) {\n            direction[1] = -1;\n        } else if (startRect.top + startRect.height < clientY + scrollThreshold) {\n            direction[1] = 1;\n        }\n        if (startRect.left > clientX - scrollThreshold) {\n            direction[0] = -1;\n        } else if (startRect.left + startRect.width < clientX + scrollThreshold) {\n            direction[0] = 1;\n        }\n        if (!direction[0] && !direction[1]) {\n            return false;\n        }\n\n        this.prevDirection = direction;\n        this.prevPos = getScrollPosition({ scrollContainer: container, direction });\n\n        this.trigger(\"scroll\", {\n            scrollContainer: container,\n            direction,\n        });\n        return true;\n\n    }\n    public dragAfter() {\n        const {\n            prevPos,\n            prevDirection: direction,\n            container: scrollContainer,\n        } = this;\n\n        if (!this.prevDirection) {\n            return false;\n        }\n        const {\n            getScrollPosition,\n        } = this.options;\n        const nextPos = getScrollPosition({ scrollContainer, direction });\n        const offsetX = nextPos[0] - prevPos[0];\n        const offsetY = nextPos[1] - prevPos[1];\n\n        if (!offsetX && !offsetY) {\n            return false;\n        }\n        this.trigger(\"move\", {\n            offsetX: direction[0] ? offsetX : 0,\n            offsetY: direction[1] ? offsetY : 0,\n        });\n        return true;\n    }\n}\n"],"names":["getDefaultScrollPosition","e","scrollContainer","scrollLeft","scrollTop","__extends","container","options","_super","_this","scrollThreshold","getScrollPosition","_a","top","left","width","height","startRect","clientX","clientY","prevDirection","_b","_c","_d","direction","prevPos","trigger","nextPos","offsetX","offsetY","Component"],"mappings":"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"}