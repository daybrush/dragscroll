/*
Copyright (c) 2019 Daybrush
name: @scena/dragscroll
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/dragscroll.git
version: 1.1.0
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).DragScroll=e()}(this,function(){"use strict";var c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function o(t){return t&&"object"==typeof t}var i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function s(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}return function(e){function t(){this.constructor=n}var n,r;function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._startRect=null,t._startPos=[],t._prevTime=0,t._timer=0,t._prevScrollPos=[0,0],t}c(n=i,r=e),n.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t);var o=i.prototype;return o.dragStart=function(t,e){var n=e.container,r=0,i=0,o=0,c=0;if(n===document.body)o=window.innerWidth,c=window.innerHeight;else{var s=n.getBoundingClientRect();r=s.top,i=s.left,o=s.width,c=s.height}this._startPos=[t.clientX,t.clientY],this._startRect={top:r,left:i,width:o,height:c},this._prevScrollPos=this._getScrollPosition([0,0],e)},o.drag=function(t,e){var n=t.clientX,r=t.clientY,i=e.threshold,o=void 0===i?0:i,c=this._startRect,s=this._startPos,l=[0,0];return c.top>r-o?(s[1]>c.top||r<s[1])&&(l[1]=-1):c.top+c.height<r+o&&(s[1]<c.top+c.height||r>s[1])&&(l[1]=1),c.left>n-o?(s[0]>c.left||n<s[0])&&(l[0]=-1):c.left+c.width<n+o&&(s[0]<c.left+c.width||n>s[0])&&(l[0]=1),clearTimeout(this._timer),!(!l[0]&&!l[1])&&this._continueDrag(a(a({},e),{direction:l,inputEvent:t,isDrag:!0}))},o.checkScroll=function(t){var e=this,n=t.prevScrollPos,r=void 0===n?this._prevScrollPos:n,i=t.direction,o=t.throttleTime,c=void 0===o?0:o,s=t.inputEvent,l=t.isDrag,u=this._getScrollPosition(i||[0,0],t),a=u[0]-r[0],f=u[1]-r[1],h=i||[a?Math.abs(a)/a:0,f?Math.abs(f)/f:0];return this._prevScrollPos=u,!(!a&&!f)&&(this.trigger("move",{offsetX:h[0]?a:0,offsetY:h[1]?f:0,inputEvent:s}),c&&l&&(this._timer=window.setTimeout(function(){e._continueDrag(t)},c)),!0)},o.dragEnd=function(){clearTimeout(this._timer)},o._getScrollPosition=function(t,e){var n=e.container,r=e.getScrollPosition;return(void 0===r?s:r)({container:n,direction:t})},o._continueDrag=function(t){var e=this,n=t.container,r=t.direction,i=t.throttleTime,o=t.useScroll,c=t.inputEvent,s=Date.now?Date.now():(new Date).getTime(),l=Math.max(i+this._prevTime-s,0);if(0<l)return this._timer=window.setTimeout(function(){e._continueDrag(t)},l),!1;this._prevTime=s;var u=this._getScrollPosition(r,t);return this._prevScrollPos=u,this.trigger("scroll",{container:n,direction:r,inputEvent:c}),o||this.checkScroll(a(a({},t),{prevScrollPos:u,direction:r,inputEvent:c}))},i}(function(){function t(){this._events={}}var e=t.prototype;return e.on=function(t,e){if(o(t))for(var n in t)this.on(n,t[n]);else this._addEvent(t,e,{});return this},e.off=function(t,e){if(t)if(o(t))for(var n in t)this.off(n);else if(e){var r=this._events[t];if(r){var i=function(t,e,n){void 0===n&&(n=-1);for(var r=t.length,i=0;i<r;++i)if(e(t[i],i,t))return i;return n}(r,function(t){return t.listener===e});-1<i&&r.splice(i,1)}}else this._events[t]=[];else this._events={};return this},e.once=function(e,t){var n=this;return t&&this._addEvent(e,t,{once:!0}),new Promise(function(t){n._addEvent(e,t,{once:!0})})},e.emit=function(e,n){var r=this;void 0===n&&(n={});var t=this._events[e];if(!e||!t)return!0;var i=!1;return n.eventType=e,n.stop=function(){i=!0},n.currentTarget=this,function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],c=0,s=o.length;c<s;c++,i++)r[i]=o[c];return r}(t).forEach(function(t){t.listener(n),t.once&&r.off(e,t.listener)}),!i},e.trigger=function(t,e){return void 0===e&&(e={}),this.emit(t,e)},e._addEvent=function(t,e,n){var r=this._events;r[t]=r[t]||[],r[t].push(i({listener:e},n))},t}())});
//# sourceMappingURL=dragscroll.min.js.map
